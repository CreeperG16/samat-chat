<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="/login">
    <title>login | samat chat</title>
    <link rel="stylesheet" href="style/global.css">
    <link rel="stylesheet" href="login/login.css">
    <link rel="icon" type="image/png" href="images/favicon.png">
    <script type="importmap">
        { "imports": { "@supabase/supabase-js": "https://esm.sh/@supabase/supabase-js" } }
    </script>
    <script type="module" src="login/login.js"></script>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
</head>
<body>
    <div id="content">
        <h1>
            <span class="mode-switcher">
                <span class="mode selected" data-mode="login">Log into</span>
                <span class="mode" data-mode="signup">Sign up for</span>
            </span>
            <span>samat chat</span>
        </h1>

        <p id="err-msg"></p>

        <form>
            <input type="hidden" name="mode" id="mode-selector" value="login">
            <input type="email" name="email" id="email" placeholder="Email" pattern="^[^\s@]+@[^\s@]+\.[^\s@]+$">
            <input type="text" name="username" id="username" placeholder="Username" pattern="^[a-zA-Z_\.0-9]{4,}" class="hidden">
            <input type="password" name="password" id="password" placeholder="Password">
            <div class="turnstile-container">
                <div class="cf-turnstile" data-sitekey="0x4AAAAAACQpgCzEwFTFxjqF" data-callback="onTurnstileSuccess"></div>
            </div>
            <button type="submit">Go</button>
        </form>
    </div>

    <div class="hidden" id="email-overlay">
        <h1>Verify your email</h1>
        <p>Check your inbox for an email. Click the link in the email to verify your account.</p>
    </div>

    <div id="err-banner">
        <p class="title">Error</p>
        <p class="where"></p>
        <pre class="message"></pre>
        <div class="progress"></div>
        <button onclick="this.parentElement.classList.remove('has-err')">X</button>
    </div>

    <div id="confirm-dialog" class="">
        <div class="container">
            <p class="title">Confirm</p>
            <p class="message"></p>
            <div class="actions">
                <button class="cancel">Cancel</button>
                <button class="confirm">Confirm</button>
            </div>
        </div>
    </div>
</body>
</html>
